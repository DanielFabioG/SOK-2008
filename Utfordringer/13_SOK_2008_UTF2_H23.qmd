---
title: "Utfordring 2.1 og 2.2"
subtitle: "Fakultet for biovitenskap, fiskeri og økonomi."
date: last-modified
date-format: "DD-MM-YYYY"
author: "Kandidatnummer 13, SOK-2008, Høst 2023"
format: pdf
echo: false
toc: true
toc-title: "Innholdsliste"
warning: false
bibliography: referanse2.bib
csl: norsk-apa-manual.csl
nocite: |
  @*
---

```{r}
#| output: false

# Loading packages needed
rm(list = ls())
library(tidyverse)
library(eurostat)
library(ggrepel)
```

```{r}
#| output: false
# Using the package eurostat to download the data needed
# Getting the data for minimum wage in percentage of mean wage
eurostat_1 <- get_eurostat(id = "earn_mw_avgr2", 
                     type = "label")
# Getting employment data
eurostat_2 <- get_eurostat(id = "lfsi_emp_a", 
                     type = "label")
```

```{r}
# Filtering out what I dont want and letting what I want to look at remain
eurostat_1 <- eurostat_1 %>%
  filter(indic_se == 'Monthly minimum wage as a proportion of the mean gross monthly earnings',
         time == "2021-01-01",
         nace_r2 == "Business economy",
         !geo %in% c("Montenegro", "Albania"))

# Same for eurostat_2
eurostat_2 <- eurostat_2 %>%
  filter(age == 'From 20 to 64 years',
         time == "2021-01-01",
         sex == "Total",
         unit == 'Percentage of total population',
         !geo %in% c('Euro area – 20 countries (from 2023)',
                         'European Union - 27 countries (from 2020)',
                         'Euro area – 20 countries (from 2023)',
                         'European Union - 27 countries (from 2020)'),
         indic_em == 'Persons in the labour force (former name: active persons)')


#Merging the filtered dataframes to one dataframe
eurostat <- merge(eurostat_1, eurostat_2, by=c("geo", "time"))

# Removing the old dataframes
rm(eurostat_1, eurostat_2)
```

# Innledning

# Utfordring 2.1 Minstelønn

```{r}
#| output: FALSE

model<- lm(values.y~values.x, eurostat)
```

```{r}
eurostat %>%
  ggplot(aes(x=values.y, y=values.x, label=geo))+
  geom_point(color = "palevioletred")+
  geom_text_repel()+
  labs(y="Minstelønninger i % av gjennomsnittlig bruttoinntekt", x="Sysselsetingsprosent for alder 20-64",
       caption= "Source: Eurostat",
       title= "Dunno yet")+
  theme_minimal()+
  geom_smooth(method = lm, se = FALSE, color = "cornflowerblue")
```

Episk forklaring av den forholdsvis enkle grafen som vektlegges mer enn hva selve koden for å lage figuren tok.

# Utfordring 2.2 Fagforeninger

# Appendiks

Bruk av KI: ChatGPT 4 inkludert advanced data analysis.

[ChatGPT forespørsel for å fikse datasett for første figur](https://chat.openai.com/share/26eade71-5a65-4eaf-9ea7-09ecf978cff6) (Endte opp med å bruke koden eurostat \<- merge(eurostat_1, eurostat_2, by=c("geo", "time")), og en annen bare for å se på hvilke land som var ikke var felles for begge datasett, denne fjernet jeg etter at jeg tok å filtrerte dem ut siden den ikke var relevant lengre)

# Referanser
